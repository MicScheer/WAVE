*CMZ : 00.00/15 12/10/2013  12.22.24  by  Michael Scheer
*CMZ : 00.00/07 07/06/2011  14.38.25  by  Michael Scheer
*CMZ : 00.00/02 26/03/97  10.21.43  by  Michael Scheer
*CMZ : 00.00/00 10/01/95  18.02.45  by  Michael Scheer
*-- Author :    Michael Scheer   10/01/95
      SUBROUTINE UTIL_SPLINE_EXPAND(NI,XI,FI,NE,XE,FE,CI,WS1,WS2,WS3,WS4)

C--- THE FUNCTION FI(XI) OF THE SORTED ARRAY XI(1...NI)
C    IS EXPANDED TO FE(XE) OF THE EQUALIY SPACED ARRAY XE(1...NE)

      IMPLICIT NONE

      INTEGER NI  !DIMENSION OF INPUT ARRAYS XI AND FI
      INTEGER NE  !DIMENSION OF OUTPUT ARRAYS XE AND FE

      INTEGER IE

      REAL*8 XI(NI),FI(NI)
      REAL*8 XE(NE),FE(NE)
      REAL*8 CI(NI)  !SPLINE COEFFICIENTS OF FI, MUST BE PROVIDED AS WORKINGSPACE
      REAL*8 WS1(NI),WS2(NI),WS3(NI),WS4(NI)  ! MUST BE PROVIDED AS WORKINGSPACE

      REAL*8 XRANGE,DX

      XRANGE=XI(NI)-XI(1)
      DX=XRANGE/dble(NE-1)

      CALL UTIL_SPLINE_COEF(XI,FI,NI,9999.0d0,9999.0d0,CI,WS1,WS2,WS3,WS4)

      DO IE=1,NE
          XE(IE)=XI(1)+dble(IE-1)*DX
          CALL UTIL_SPLINE_INTER(XI,FI,CI,NI,XE(IE),FE(IE),0)
      ENDDO !NE


      RETURN
      END
